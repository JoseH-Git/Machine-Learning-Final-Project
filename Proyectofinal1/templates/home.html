{% extends "layout.html" %}

{% block content %}
<!-- <html>
    <link rel="stylesheet" href="main.css">
</html> -->


<body onload="attrLoader()" >
<div class="container" style="margin-top: 20px;">
    <div class="card">
        <div class="card-header text-center">
            <h4><b>Classification Analysis: Predict Attrition</b></h4>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-8">
                    <div class="card">
                        <div class="card-header text-center"><h5><b>Employee Information</b></h5></div>
                        <form id="inputForm">
                        <div class="card-body">                            
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Emp_type</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Emp_type" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Gate</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Gate" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Gender</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Gender" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Department</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Department" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Country</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Country" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Function</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Function" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">control_point</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="control_point" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Scale</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Scale" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Promotions</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Promotions" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Intern_Asig</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Intern_Asig" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Age</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Age" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Seniority</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Seniority" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Dependents</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Dependents" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Job_Code</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Job_Code" id="" value = "0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Comparatio</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="Comparatio" id="" value = "0">
                                </div>
                            </div>
                            <!-- <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Body Type</label>
                                </div>
                                <div class="col-md-9">
                                    <input class="form-control" type="text" name="BodyType" id="" value = "i.e. sedan">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <div class="col-md-3">
                                        <label class="control-label">Fleet</label>
                                    </div>
                                    <select id="fleet" name="Fleet">
                                        <option value="Empty">-----</option>
                                        <option value=0>False</option>
                                        <option value=1>True</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Has Accidents</label>
                                </div>
                                <select id="hasAccidents" name="HasAccidents">
                                    <option value="Empty">-----</option>
                                    <option value=0>False</option>
                                    <option value=1>True</option>
                                </select>
                            </div>
                           
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Year</label>
                                </div>
                                <select id="attr_year" name="Year">
                                    <option value="Empty">----</option>
                                </select>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Make</label>
                                </div>
                                <select id="attr">
                                    <option value="Empty">----</option>
                                </select>
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Model</label>
                                </div>
                                <select id="attr2">
                                    <option value="Empty">----</option>
                                </select>
                               
                            </div>
                            <div class="row">
                                <div class="col-md-3">
                                    <label class="control-label">Trims</label>
                                </div>
                                <div class="radio-toolbar" id="bttns" name ="trims">
                                </div>
                            </div>          -->
                            <hr>

                            <div class="card-footer text-center">
                                <button type = "button" class="btn btn-info" onclick="getResult()" value = "submit" style="cursor: pointer;">Predict</button>
                            </div>
                        </div>
                    </form>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="card">
                    <div class="card-header text-center"><h5><b>Prediction Result</b></h5></div>
                    <div class="card-body">
                        <div class="row">
                            Model Predicted Foreclosure->&nbsp;&nbsp; <span style="color:red"><p id="result"></p></span>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
<script>
    var trim_name="";
    
    function getResult(){
        $("#progressBar").modal('show')
        $.ajax({
           type: "POST",
           url: "{{url_for('getResponseLinearReg')}}",
           data: $("#inputForm").serialize(), // serializes the form's elements.
           success: function(data)
           {
              $("#result").html(data); 
           },complete:function()
           {
            $("#progressBar").modal('hide')
           }
         });
    }

    // Selector Buttons
    function buttonReset(){
        var divBttns = document.getElementById('bttns');
        while(divBttns.firstChild){
            divBttns.removeChild(divBttns.lastChild);
            
        }    
    }

    function buttonLoader(s){
        divBttns = document.getElementById('bttns');
        var keys2 = attr_dict2[s];

        for (i = 0; i < keys2.length; i++) {
            var radio = document.createElement('input');
            var label = document.createElement('label');

            radio.type = 'radio';
            radio.text = radio.value = keys2[i];
            // radio.name = radio.type+s;
            radio.name = 'trim';
            radio.id = radio.type+radio.text;

            label.innerHTML = keys2[i];
            label.htmlFor = radio.id;

            divBttns.appendChild(radio, -1);
            divBttns.appendChild(label, -1);

            if(i == 0) {
                radio.checked=true;
                trim_name = keys2[i];
            }
        }
    }

    // Second Attribute
    function attr2Reset(){
        var attr2 = document.getElementById('attr2');
        while(attr2.firstChild){
            attr2.removeChild(attr2.lastChild);
        }    
        var option = document.createElement('option');
        option.text = option.value = '----'
        attr2.add(option, -1);
    }

    function attr2Loader(s){
        select = document.getElementById('attr2');
        var keys = attr_dict1[s];
        for (i = 0; i < keys.length; i++) {
            var option = document.createElement('option');
            option.text = option.value = keys[i]
            select.add(option, -1);
        }
    }
    // -----------------

    // First Attribute
    function attr1Reset(){
        var attr = document.getElementById('attr');
        while(attr.firstChild){
            attr.removeChild(attr.lastChild);
        }    
        var option = document.createElement('option');
        option.text = option.value = '----'
        attr.add(option, -1);
    }

    function attrLoader1(s){
        select = document.getElementById('attr');
        var keys = year_dict[s];

        for (i = 0; i < keys.length; i++) {
            var option = document.createElement('option');
            option.text = option.value = keys[i]
            select.add(option, -1);
        }
    }
    // -----------------

    // First Attribute
    function attrLoader(){
        select = document.getElementById('attr_year');
        for (i = 0; i < year_keys.length; i++) {
            var option = document.createElement('option');
            option.text = option.value = year_keys[i]
            select.add(option, -1);
        }
    }
    // -----------------

    // Input Listeners
    document.addEventListener('input', function (event) {
        if (event.target.id === 'attr_year'){
            console.log(event.target.value);
            attr1Reset()
            attr2Reset()
            buttonReset()
            if(event.target.selectedIndex-1 > -1) attrLoader1(event.target.value)
        }
        else if (event.target.id === 'attr'){
            console.log(event.target.value);
            attr2Reset()
            buttonReset()
            if(event.target.selectedIndex-1 > -1) attr2Loader(event.target.value)
        }
        else if (event.target.id === 'attr2'){
            console.log(event.target.value);
            
            buttonReset()
            if(event.target.selectedIndex-1 > -1) buttonLoader(event.target.value)
        }
        else if (event.target.type === 'radio') {
            trim_name = event.target.value;
            console.log(event.target.value);
            getTrimName(event.target.value);


        }
    }, false);
</script>

{% endblock %}